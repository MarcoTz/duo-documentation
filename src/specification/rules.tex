\documentclass[11pt]{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{mathtools}
\usepackage{xcolor}
\usepackage{csquotes}

\newcommand{\translate}[1]{\llbracket #1 \rrbracket}
\newcommand{\C}{\mathcal{C}}

\newcommand{\case}[1]{\mathbf{case}\ \{\ #1\ \}}
\newcommand{\caseof}[2]{\mathbf{case}\ #1\ \mathbf{of}\ \{\ #2\ \}}

\newcommand{\pat}[1]{\C\Gamma \Rightarrow #1 }
\newcommand{\prdpat}[2]{\C\Gamma(#1)\Delta \Rightarrow #2 }
\newcommand{\cnspat}[2]{\C\Gamma[#1]\Delta \Rightarrow #2 }

\newcommand{\nonterminal}[1]{\langle #1 \rangle}
\newcommand{\terminal}[1]{\colorbox{lightgray}{\vphantom{X}#1}}
\newcommand{\cut}[2]{\langle\ #1\ |\ #2\ \rangle}

\begin{document}

\section{Duo Reference}

\subsection{Duo Syntax}
This section describes the syntax as it is implemented in the parser.
Only a subset of this syntax is a valid Duo program.

\subsubsection{Variables and Identifiers}
\[
  \begin{array}{lclr}
    \nonterminal{var} & \Coloneqq & [a..z][a..zA..Z0..9] & \emph{Variable} \\
    \nonterminal{tyvar} & \Coloneqq & [a..z][a..zA..Z0..9] & \emph{Type Variable} \\
    \nonterminal{tyname} & \Coloneqq & [A..Z][a..zA..Z0..9] & \emph{Type Name} \\
    \nonterminal{xtorname} & \Coloneqq & [A..Z][a..zA..Z0..9] & \emph{Xtor Name} \\
    \nonterminal{modname} & \Coloneqq &  [A..Z][a..zA..Z0..9] & \emph{Module Name} \\
    \nonterminal{hmodname} & \Coloneqq & \nonterminal{modname}(\terminal{.}\nonterminal{modname})^{\ast} & \emph{Hierarchical M. Name}
  \end{array}
\]

\subsubsection{Primitive Literals}
\[
  \begin{array}{lclr}
    \nonterminal{intlit} & \Coloneqq & \ldots & \emph{Integer Literal} \\
    \nonterminal{floatlit} & \Coloneqq & \ldots & \emph{Float Literal} \\
    \nonterminal{charlit} & \Coloneqq & \ldots & \emph{Char Literal} \\
    \nonterminal{stringlit} & \Coloneqq & \ldots & \emph{String Literal} \\
  \end{array}
\]

\subsubsection{Patterns}
\[
  \begin{array}{lclr}
    \nonterminal{pat} & \Coloneqq & \nonterminal{var} & \emph{Variable Pattern} \\
    & | & \terminal{\_} & \emph{Wildcard Pattern} \\
    & | & \nonterminal{xtorname}\terminal{(}\nonterminal{pat}^{\ast} \terminal{)} & \emph{Xtor Pattern}\\
    & | & \terminal{$\ast$} & \emph{Star Pattern} \\
  \end{array}
\]

\subsubsection{Terms and Commands}
\[
  \begin{array}{lclr}
    \nonterminal{tm} & \Coloneqq & \nonterminal{var} & \emph{Variable} \\
    & | & \terminal{mu}\ \nonterminal{var} \terminal{.} \nonterminal{tm} & \textit{Mu Abstraction} \\
    & | & \nonterminal{tm} \terminal{$\gg$} \nonterminal{tm} & \textit{Apply} \\
    & | & \nonterminal{xtorname}\nonterminal{subst} & \emph{Xtor} \\
    & | & \terminal{case}\ \terminal{\{} (\nonterminal{pat} \terminal{$\Rightarrow$} \nonterminal{tm})^{\ast} \terminal{\}} & \emph{Case} \\
    & | & \terminal{case}\ \nonterminal{tm}\ \terminal{of}\ \terminal{\{} (\nonterminal{pat} \terminal{$\Rightarrow$} \nonterminal{tm})^{\ast} \terminal{\}} & \emph{CaseOf} \\
    & | & \terminal{cocase}\ \terminal{\{} (\nonterminal{pat} \terminal{$\Rightarrow$} \nonterminal{tm})^{\ast} \terminal{\}} & \emph{Cocase} \\
    & | & \terminal{cocase}\ \nonterminal{tm}\ \terminal{of}\ \terminal{\{} (\nonterminal{pat} \terminal{$\Rightarrow$} \nonterminal{tm})^{\ast} \terminal{\}} & \emph{CocaseOf} \\
    & | & \nonterminal{xtorname}\nonterminal{starsubst}\terminal{;;}\nonterminal{tm} & \emph{Semi} \\
    & | & \nonterminal{tm}\terminal{.}\nonterminal{xtorname}\nonterminal{starsubst} & \emph{Dtor} \\
    & | & \terminal{$\backslash$} \nonterminal{var}^{\ast}\terminal{$\Rightarrow$} \nonterminal{tm} & \emph{MultiLambda} \\
    & | & \nonterminal{tm} \nonterminal{tm} & \emph{FunApp} \\
    & | & \nonterminal{floatlit}\terminal{$\#F64$} & \emph{PrimLitF64} \\
    & | & \nonterminal{intlit}\terminal{$\#I64$} & \emph{PrimLitI64} \\
    & | & \nonterminal{stringlit} & \emph{Primitive String} \\
    & | & \nonterminal{charlit} & \emph{Primitive Char} \\
    \nonterminal{subst} & \Coloneqq & \terminal{(} \nonterminal{tm}^{\ast} \terminal{)} & \emph{Substitution} \\
    \nonterminal{starsubst} & \Coloneqq & \terminal{(} \nonterminal{tm}^{\ast} \terminal{*} \nonterminal{tm}^{\ast} \terminal{)} & \emph{Star Substitution} \\ 
  \end{array}
\]

\subsubsection{Kinds}
\[
  \begin{array}{lclr}
    \nonterminal{evalorder} & \Coloneqq & \terminal{CBV}\ |\ \terminal{CBN} & \emph{Evaluation Order} \\
    \nonterminal{monokind} & \Coloneqq & \nonterminal{evalorder} & \emph{Monokind} \\
    & | & \terminal{I64Rep} & \emph{I64Rep} \\
    & | & \terminal{F64Rep} & \emph{F64Rep} \\
    & | & \terminal{StringRep} & \emph{StringRep} \\
    & | & \terminal{CharRep} & \emph{CharRep} \\
    \nonterminal{variance} & \Coloneqq & \terminal{+}\ |\ \terminal{-} & \emph{Variance} \\
    \nonterminal{polykind$-$p} & \Coloneqq & \nonterminal{variance}\nonterminal{tyvar} \terminal{:} \nonterminal{monokind} & \emph{Polykind Parameter} \\
    \nonterminal{polykind} & \Coloneqq & \terminal{(} (\nonterminal{polykind$-$p})^{\ast}\terminal{)} \terminal{$\rightarrow$} \nonterminal{monokind} & \emph{Polykind} \\
  \end{array}
\]
\subsubsection{Types}
\[
  \begin{array}{lclr}
    \nonterminal{monotype} & \Coloneqq & \ldots & \emph{Monotype} \\
    \nonterminal{forall} & \Coloneqq & \terminal{$\forall$}\ |\ \terminal{forall} & \emph{Forall} \\
    \nonterminal{polytype} & \Coloneqq & \nonterminal{monotype} & \emph{Polytype} \\
    & | & \nonterminal{forall} (\nonterminal{tyvar}\ |\ \terminal{(} \nonterminal{tyvar} \terminal{:} \nonterminal{evalorder}\terminal{)})^{\ast}\terminal{.} \nonterminal{monotype} & \emph{Typescheme} \\
  \end{array}
\]
\subsubsection{Declarations and Modules}

\[
  \begin{array}{lclr}
    \nonterminal{datadecl} & \Coloneqq & \ldots & \emph{Data declaration} \\
    \nonterminal{xtordecl} & \Coloneqq & \ldots & \emph{Xtor declaration} \\
    \nonterminal{tysyndecl} & \Coloneqq & \ldots & \emph{Type synonym declaration} \\
    \nonterminal{tyopdecl} & \Coloneqq & \ldots & \emph{Type operator declaration} \\
    \nonterminal{importdecl} & \Coloneqq & \terminal{import} \nonterminal{hmodname}\terminal{;} & \emph{Import declaration} \\
    \nonterminal{decl} & \Coloneqq & \nonterminal{importdecl}  & \emph{Import declaration} \\
    & | & \nonterminal{datadecl} & \emph{Data declaration} \\
    & | & \nonterminal{xtordecl} & \emph{Xtor declaration} \\
    & | & \nonterminal{tysyndecl} & \emph{Type synonym declaration} \\
    & | & \nonterminal{tyopdecl} & \emph{Type operator declaration} \\
    \nonterminal{mod} & \Coloneqq & \terminal{module} \nonterminal{hmodname} \terminal{;} \nonterminal{decl}^{\ast}& \emph{Module}
  \end{array}
\]

\end{document}